#lang racket
(define espacio 50)
(define espmod 50)
(define vechoras 0)
(define (buscarplaca placa indice vecplacas)
  (if (< indice espacio)
      (if (= (vector-ref vecplacas indice) placa)
          indice
          (buscarplaca placa (+ indice 1) vecplacas espacio))
      -1))

(define (desocupado vecplacas indice espacio)
  (if (< indice espacio)
      (if (= -1 (vector-ref vecplacas indice))
          indice
          (desocupado vecplacas (+ indice 1)))
      -1))

(define (ingreso vecplacas vechoras indice espacio)
  (if (= espacio (- espacio espmod))            
      (display "No hay espacio en el parqueadero. ")
      (if (< indice espacio)
          (begin
            (display "Por favor digite la placa de el auto: ")
            (vector-set! vecplacas (desocupado vecplacas 0) (read))
            (display "Por favor digite la hora de ingreso: ")
            ((vector-set! vechoras )(desocupado vechoras 0) (read))
            (- espmod 1))
          (display "ERROR EN LA FUNCION DE INGRESO")
          )))


(define (salida vecplacas vechoras)
  (define indice 0)
  (define h 0)
  (display "Por favor digite la placa: ")
  (set! indice (buscarplaca (read) 0 vecplacas espacio))
  (display "Hora de salida: ")
  (set! h (read))
  (display "Total a pagar: ")
  (display (* 1800 (- h (vector-ref vechoras indice))))
  (displayln "Que pase un buen día")
  (vector-set! vecplacas indice -1)
  (vector-set! vechoras indice -1)
  (set! espmod (+ espmod 1)))

(define (horastotales vecplacas vechoras)
  (define placa 0)
  (define h 0)
  (display "Digite la placa del vehículo: ")
  (set! placa (read))
  (display "¿Qué hora es? ")
  (set! h (read))
  (display "Las horas que lleva el usuario en el parqueadero son: ")
  (display (- h (vector-ref vechoras (buscarplaca placa 0 vecplacas espacio))))
  )
;//FUNCION QUE DICE CUANTOS ESPACIOS HAY DISPONIBLES 
(define (disponibles)
  (printf "Los espacios disponibles son: ~a" (- espmod espacio)))

(define (operarocho vechoras indice hora cantidad)
  (if (< indice espacio)
      (if (>= (vector-ref vechoras indice)8)
         (operarocho vechoras indice hora (+ 1 cantidad))
         (operarocho vechoras indice hora cantidad))
      cantidad))
(define (ochoras)
  (define h 0)
  (display "¿Qué hora es?")
  (set! h (read))
  (printf "Los vehículos que llevan 8 horas son: ")
  (operarocho vechoras 0 h 0))

(define (PARQUEADERO)
  ())
